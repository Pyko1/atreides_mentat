{"version":3,"sources":["ts/ViewState.ts","ts/HouseState.ts","ts/strings.ts","ts/components/NewGame.tsx","ts/components/HouseTile.tsx","ts/components/GameOverview.tsx","ts/ViewManager.tsx","serviceWorker.ts","ts/RootState.ts","ts/Store.ts","index.tsx"],"names":["showNewGame","createAction","showOverview","showHouseDetails","showEditSpice","showAddCard","defaultViewState","active_view","house_name","undefined","viewStateReducer","createReducer","builder","addCase","state","action","payload","addCard","card","removeCard","index","modifySpice","spice","Number","isInteger","Error","toggleHouse","ALL_HOUSE_NAMES","getHouse","name","house","houseStateReducer","cards","push","splice","houseNameStr","assertNever","houses","useSelector","allow_start","i","dispatch","useDispatch","map","key","type","checked","onChange","value","disabled","onClick","HouseTile","props","readOnly","GameOverview","housesArray","houseState","ViewManager","view","house_state","NewGame","Boolean","window","location","hostname","match","rootReducer","combineReducers","stateStore","createStore","ReactDOM","render","store","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.fa3424d7.chunk.js","sourcesContent":["import { HouseName } from \"./HouseState\";\nimport { createAction, createReducer } from \"@reduxjs/toolkit\";\n\nexport type View = \"new_game\" | \"overview\" | \"house_details\" | \"edit_spice\" | \"add_card\";\n\nexport interface ViewState {\n  active_view: View;\n  house_name?: HouseName;\n}\n\nexport const showNewGame = createAction(\"view/new_game\");\nexport const showOverview = createAction(\"view/overview\");\nexport const showHouseDetails = createAction<HouseName>(\"view/house_details\");\nexport const showEditSpice = createAction<HouseName>(\"view/edit_spice\");\nexport const showAddCard = createAction<HouseName>(\"view/add_card\");\n\nconst defaultViewState: ViewState = {\n  active_view: \"new_game\",\n  house_name: undefined,\n};\n\nexport const viewStateReducer = createReducer(defaultViewState, builder => {\n  builder.addCase(showNewGame, (state, action) => {\n    state.active_view = \"new_game\";\n    state.house_name = undefined;\n  });\n\n  builder.addCase(showOverview, (state, action) => {\n    state.active_view = \"overview\";\n    state.house_name = undefined;\n  });\n\n  builder.addCase(showHouseDetails, (state, action) => {\n    state.active_view = \"house_details\";\n    state.house_name = action.payload;\n  });\n\n  builder.addCase(showEditSpice, (state, action) => {\n    state.active_view = \"edit_spice\";\n    state.house_name = action.payload;\n  });\n\n  builder.addCase(showAddCard, (state, action) => {\n    state.active_view = \"add_card\";\n    state.house_name = action.payload;\n  });\n});\n","import { createAction, createReducer } from \"@reduxjs/toolkit\";\nimport { TreacheryCard } from \"./TreacheryCard\";\nimport { showNewGame } from \"./ViewState\";\n\nexport interface HouseState {\n  spice: number;\n  cards: Array<TreacheryCard>;\n}\n\nexport const addCard = createAction(\n  \"houses/add_card\",\n  (house_name: HouseName, card: TreacheryCard) => {\n    return {\n      payload: {\n        house_name,\n        card,\n      },\n    };\n  }\n);\n\nexport const removeCard = createAction(\n  \"houses/remove_card\",\n  (house_name: HouseName, index: number) => {\n    return {\n      payload: {\n        house_name,\n        index,\n      },\n    };\n  }\n);\n\nexport const modifySpice = createAction(\n  \"houses/modify_spice\",\n  (house_name: HouseName, spice: number) => {\n    if (!Number.isInteger(spice)) {\n      throw new Error(\"Spice value must be an integer\");\n    }\n    return {\n      payload: {\n        house_name,\n        spice,\n      },\n    };\n  }\n);\n\nexport const toggleHouse = createAction<HouseName>(\"houses/toggle_house\");\n\nexport const ALL_HOUSE_NAMES = [\"harkonen\", \"guild\", \"emperor\", \"bene\", \"fremen\"] as const;\nexport type HouseNameTuple = typeof ALL_HOUSE_NAMES;\nexport type HouseName = HouseNameTuple[number];\n\nexport type HousesState = {\n  [key in HouseName]?: HouseState;\n};\n\nconst defaultState: HousesState = {};\n\nfunction getHouse(name: HouseName, state: HousesState) {\n  const house = state[name];\n  if (house === undefined) {\n    throw new Error(\"House \" + name + \" not present in this game\");\n  }\n  return house;\n}\n\nexport const houseStateReducer = createReducer(defaultState, builder => {\n  builder.addCase(addCard, (state, action) => {\n    let house = getHouse(action.payload.house_name, state);\n    house.cards.push(action.payload.card);\n  });\n\n  builder.addCase(removeCard, (state, action) => {\n    let house = getHouse(action.payload.house_name, state);\n    house.cards.splice(action.payload.index, 1);\n  });\n\n  builder.addCase(modifySpice, (state, action) => {\n    let house = getHouse(action.payload.house_name, state);\n    house.spice += action.payload.spice;\n    if (house.spice < 0) {\n      house.spice = 0;\n    }\n  });\n\n  builder.addCase(toggleHouse, (state, action) => {\n    let house = state[action.payload];\n    if (house !== undefined) {\n      state[action.payload] = undefined;\n    } else {\n      state[action.payload] = {\n        cards: [],\n        spice: 0, // TODO actually get the starting spice by house\n      };\n    }\n  });\n\n  builder.addCase(showNewGame, (state, action) => {\n    return {};\n  });\n});\n","import { HouseName } from \"./HouseState\";\n\nfunction assertNever(): never {\n    throw new Error(\"Missing case in switch\");\n}\n\nexport function houseNameStr(name: HouseName) {\n    switch (name) {\n        case \"bene\": return \"Bene Geserit\";\n        case \"harkonen\": return \"Harkonen\";\n        case \"fremen\": return \"Fremen\"\n        case \"guild\": return \"Spacing Guild\";\n        case \"emperor\": return \"The Emperor\"\n        default: return assertNever();\n    }\n}","import * as React from \"react\";\nimport { ALL_HOUSE_NAMES, toggleHouse } from \"ts/HouseState\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { houseNameStr } from \"ts/strings\";\nimport { RootState } from \"ts/RootState\";\nimport { showOverview } from \"ts/ViewState\";\n\nexport default () => {\n  const houses = useSelector((state: RootState) => state.houses);\n  let allow_start = false;\n  for (let i of ALL_HOUSE_NAMES) {\n    if (houses[i] !== undefined) {\n      allow_start = true;\n      break;\n    }\n  }\n  const dispatch = useDispatch();\n  return (\n    <div>\n      <h1>New game</h1>\n      <p>Select houses in the game</p>\n      {ALL_HOUSE_NAMES.map(name => {\n        return (\n          <div key={name}>\n            <label>\n              {houseNameStr(name)}\n              <input\n                type=\"checkbox\"\n                checked={!!houses[name]}\n                onChange={() => dispatch(toggleHouse(name))}\n              />\n            </label>\n            <div></div>\n          </div>\n        );\n      })}\n      <input\n        type=\"button\"\n        value=\"Start game\"\n        disabled={!allow_start}\n        onClick={() => {\n          if (allow_start) {\n            dispatch(showOverview());\n          }\n        }}\n      />\n    </div>\n  );\n};\n","import * as React from \"react\";\nimport { HouseName } from \"ts/HouseState\";\nimport { houseNameStr } from \"ts/strings\";\nimport { useDispatch } from \"react-redux\";\n\nexport interface HouseTileProps {\n  spice: number;\n  house_name: HouseName;\n}\n\nconst HouseTile: React.FC<HouseTileProps> = props => {\n  const dispatch = useDispatch();\n  return (\n    <div>\n      <h2>{houseNameStr(props.house_name)}</h2>\n      <label>\n        Spice\n        <input type=\"number\" value={props.spice} readOnly />\n      </label>\n      <input type=\"button\" value=\"Edit\" onClick={() => {}} />\n      <input type=\"button\" value=\"View Cards\" />\n    </div>\n  );\n};\n\nexport default HouseTile;\n","import * as React from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { ALL_HOUSE_NAMES } from \"ts/HouseState\";\nimport HouseTile from \"./HouseTile\";\nimport { RootState } from \"ts/RootState\";\nimport { showNewGame } from \"ts/ViewState\";\n\nconst GameOverview: React.FC = () => {\n  const state = useSelector((state: RootState) => ({\n    houses: state.houses,\n  }));\n  const dispatch = useDispatch();\n  const housesArray: JSX.Element[] = [];\n  for (let name of ALL_HOUSE_NAMES) {\n    const houseState = state.houses[name];\n    if (houseState !== undefined) {\n      housesArray.push(<HouseTile house_name={name} spice={houseState.spice} />);\n    }\n  }\n  return (\n    <div>\n      {housesArray}\n      <input\n        type=\"button\"\n        value=\"Reset game\"\n        onClick={() => {\n          dispatch(showNewGame());\n        }}\n      />\n    </div>\n  );\n};\n\nexport default GameOverview;\n","import React from \"react\";\nimport NewGame from \"./components/NewGame\";\nimport { useSelector } from \"react-redux\";\nimport GameOverview from \"./components/GameOverview\";\nimport { RootState } from \"./RootState\";\nimport HouseTile from \"./components/HouseTile\";\nimport { HouseName, HouseState } from \"./HouseState\";\n\nconst ViewManager: React.FC = () => {\n  const state = useSelector((state: RootState) => {\n    let house: { name: HouseName; spice: number } | undefined = undefined;\n    if (state.view.house_name !== undefined) {\n      const house_state = state.houses[state.view.house_name] as HouseState;\n      house = {\n        name: state.view.house_name,\n        spice: house_state.spice,\n      };\n    }\n    return {\n      house: house,\n      active_view: state.view.active_view,\n    };\n  });\n\n  switch (state.active_view) {\n    case \"new_game\":\n      return <NewGame />;\n    case \"overview\":\n      return <GameOverview />;\n    case \"house_details\":\n      if (state.house !== undefined) {\n        return <HouseTile spice={state.house.spice} house_name={state.house.name} />;\n      }\n      else {\n        throw new Error(\"Missing view.house_name\");\n      }\n    default: {\n      throw new Error(\"Unhandled active_view state\");\n    }\n  }\n};\n\nexport default ViewManager;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import { combineReducers } from \"redux\";\nimport { houseStateReducer } from \"./HouseState\";\nimport { viewStateReducer } from \"./ViewState\";\n\nexport const rootReducer = combineReducers({\n  houses: houseStateReducer,\n  view: viewStateReducer\n});\n\nexport type RootState = ReturnType<typeof rootReducer>;","import { createStore } from \"@reduxjs/toolkit\";\nimport { rootReducer } from \"./RootState\";\n\nexport const stateStore = createStore(rootReducer);\n\nexport type StoreDispatch = typeof stateStore.dispatch;","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport ViewManager from \"ts/ViewManager\";\nimport { Provider } from \"react-redux\";\nimport * as serviceWorker from \"./serviceWorker\";\nimport { stateStore } from \"ts/Store\";\n\nReactDOM.render(\n  <Provider store={stateStore}>\n    <ViewManager />\n  </Provider>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}